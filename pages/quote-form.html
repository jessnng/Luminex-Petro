<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>Fuel Quote Request Form</title>
        <link rel="stylesheet" href="../style/fuel-quote.css">
    </head>

    <body>
        <div class="form-container">
            <div class="header">
                <h1>Fuel Quote Request</h1>
                <p>Please fill in the indicated fields</p>
            </div>
            <form id="quoteForm">
                <label for="gallonsRequest">Gallons Requested<span style="color: red;">*</span>: </label>
                <input type="number" id="gallons" oninput="calcTotal()" required><br>

                <label for="deliveryAddress">Delivery Address: </label>
                <!-- IMPLEMENT VALUE FROM CLIENT PROFILE -->
                <input type="text" class="readonly-input" id="addressInput" readonly>
                <br>

                <label for="deliveryDate">Delivery Date: </label>
                <input type="date"><br>

                <!-- PLACEHOLDER VALUE. IMPLEMENT VALUE FROM PRICING MODULE -->
                <label for="suggestedPrice">Suggested Price per Gallon: </label>
                <input type="number" class="readonly-input" id="price" value="2.99" readonly><br>
                
                <!-- CALCULATED BY GALLONS * PRICE -->
                <label for="amountDue">Total Amount Due: </label>
                <input type="number" class="readonly-input" id="total"><br>

                <input type="submit" value="Submit">
            </form>
            <a href="../index.html">
                <button class="homebutton">Home</button>
                    </a>
        </div>
    </body>

    <script>
        // Calculate total amount 
        function calcTotal() {
            var gallons = parseFloat(document.getElementById("gallons").value);
            var total = gallons * price;
            document.getElementById("amountDue").value = total.toFixed(2);
        }

        document.getElementById('quoteForm').addEventListener('submit', function(event) {
            event.preventDefault(); // Prevent form submission

            const formData = new FormData(this); // Get form data
            const formDataObject = Object.fromEntries(formData.entries()); // Convert FormData to object

            fetch('/quote-form', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(formDataObject)
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.json();
            })
            .catch(error => {
                console.error('Error:', error.message);
                alert('Quote form failed to submit.');
      });
    });
    </script>

</html>
