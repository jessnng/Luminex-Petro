<!DOCTYPE html>
<html lang="en">
   <head>
        <meta charset="UTF-8">
        <title>User Info</title>
        <link href="../style/ProfileStyle.css" rel="stylesheet">
    </head>

    
   <body>
        <header class="header-box">
            <div class="navbar">
            <a href="/"><img src="../images/logo.jpg" class="logo"></a>
            <ul>
                <li><a href="#">About Us</a></li>
                <li><a href="#">Contact</a></li>
                <li><a href="quote-form.html">Fuel Quote</a></li>
                <li><a href="quote-history.html">Fuel History</a></li>
            </ul>
            </div>
        </header>
    
    
        <div class="box">
            <div class="user-header">
                <h2><i>User Info</i></h2>
            </div>
            <input type="hidden" id="username">
            <table class="user-info">
                <tr>
                    <td><strong>Full Name:</strong></td>
                    <td><em id="fullname"></em></td>
                </tr>
                <tr>
                    <td><strong>Address 1:</strong></td>
                    <td><em id="address1"></em></td>
                </tr>
                <tr>
                    <td><strong>Address 2:</strong></td>
                    <td><em id="address2"></em></td>
                </tr>
                <tr>
                    <td><strong>City:</strong></td>
                    <td><em id="city"></em></td>
                </tr>
                <tr>
                    <td><strong>State:</strong></td>
                    <td><em id="state"></em></td>
                </tr>
                <tr>
                    <td><strong>Zipcode:</strong></td>
                    <td><em id="zipcode"></em></td>
                </tr>
            </table>
        </div>
        
      <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Check if the user is logged in
            const loggedInUser = localStorage.getItem('loggedInUser');
                
            // If user is not logged in, redirect to the login page
            if (!loggedInUser) {
                window.location.href = 'login.html';
            } else {
                // Populate the hidden username field with the logged-in user's username
                document.getElementById('username').value = loggedInUser;
            }

             // Fetch user profile data from the server
            fetch(`/user-profile?username=${loggedInUser}`)
                .then(response => response.json())
                .then(data => {
                    console.log("User profile data received:", data);
                    document.getElementById('fullname').innerText = data.fullname;
                    document.getElementById('address1').innerText = data.address.address1;
                    document.getElementById('address2').innerText = data.address.address2 || 'N/A';
                    document.getElementById('city').innerText = data.address.city;
                    document.getElementById('state').innerText = data.address.state;
                    document.getElementById('zipcode').innerText = data.address.zipcode;
                })
                .catch(error => console.error('Error fetching user profile:', error));
                // console.log(data)
            });
        </script>
   </body>

</html>
